# Temporary kludge to allow badly ported app to compile:
if ! grep -q 'cmake_minimum_required' CMakeLists.txt ; then
  # Prepend a cmake_minimum_required stanza at the top, which enables
  # newer cmake features which the build needs:
  sed -i -e '1icmake_minimum_required(VERSION 2.8.9)\' CMakeLists.txt
fi

mkdir -p build
cd build
  cmake \
    $KDE_OPT_ARGS \
    -DCMAKE_C_FLAGS:STRING="$SLKCFLAGS" \
    -DCMAKE_C_FLAGS_RELEASE:STRING="$SLKCFLAGS" \
    -DCMAKE_CXX_FLAGS:STRING="$SLKCFLAGS" \
    -DCMAKE_CXX_FLAGS_RELEASE:STRING="$SLKCFLAGS" \
    -DCMAKE_BUILD_TYPE=Release \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DMAN_INSTALL_DIR=/usr/man \
    -DSYSCONF_INSTALL_DIR=/etc/kde \
    -DLIB_SUFFIX=${LIBDIRSUFFIX} \
    -DKSCREENSAVER_SOUND_SUPPORT=ON \
    -DBUILD_kwin-styles=OFF \
    ..

